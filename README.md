
# Dispatch Optimization Module

This module implements the power dispatch optimization for hybrid energy systems using the Pyomo library. It takes system configuration and scenario input files (in YAML format), performs cost- and emissions-based optimization, and outputs power dispatch schedules for storage units and renewable sources.

---

## ‚öôÔ∏è Functionality

- Optimizes daily power dispatch for electrical and thermal energy systems.
- Accounts for:
  - Storage system constraints (batteries, supercapacitors, hydro, PCM)
  - Renewable generation limits (PV, wind, CSP)
  - Energy import/export limits
  - User-defined objective function weights
- Outputs optimized power schedules and updates scenario YAML files with results.

---

## üß© Key Files

- `DispatchOptimisationRunner.py`  
  Main entry point that loads input, runs the optimization model, and saves outputs.Located in `DispatchOptimisation\StandaloneFunctions`. 

- `utils.py`  
  Helper functions for loading configurations, formatting data, and post-processing.

- `config_scenario_run_XX_YY.yaml`  
  Scenario input file generated by the pipeline containing initial values and optimization settings. These files are generated by pipeline dispatcher and located in `log_data\Study_Timestamp` directory. But the main template is located in `DispatchOptimisation\Config\config_template.yaml`  

- `StoRIES_Optimization_Problem.pdf`
  The optimisation model containing the considered objective functions and condtraints can be found in `DispatchOptimisation\Documents`.



---

## üì¶ Inputs

- Time series data for demand and generation
- Storage parameters (capacity, power limits, efficiency)
- Import/export price profiles
- Objective function weights and constraints (from `Config_Opt.xlsx` or YAML)

---

## üì§ Outputs

- Updated `config_scenario_run_XX_YY.yaml` with:
  - `PP_ess_X` (Power profiles of each ESS)
  - `swPP_gen_X` (Switching profiles for generators)
  - `tON_X` (Start times for shiftable loads, if applicable)

- Logs and status messages for debugging and analysis.

---

## üõ†Ô∏è Dependencies

- Python 3.12.0 (recommended)
- Pyomo
- pandas, numpy, yaml, openpyxl
- CBC Solver should be installed
 Download from: [https://github.com/coin-or/Cbc/releases](https://github.com/coin-or/Cbc/releases)  
 Recommended file: `Cbc-releases.2.10.12-w64-msvc17-md.zip` (for modern Windows systems)  
 Extract it (e.g., to `C:\cbc`)  
 Add the `C:\cbc\bin` directory to your system `Path` environment variable  
 Open a new terminal and verify installation with:
```bash
cbc --version
  ```

Install dependencies using:
```bash
pip install -r requirements.txt
```

